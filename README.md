# CVELens Generator Web Application

## Overview
The CVELens generator webapp demonstrates how to retrieve CVE (Common Vulnerabilities and Exposures) data from a PostgreSQL database, transform it into text embeddings using a Sentence Transformer model, and index it using the FAISS library for fast similarity-based search. Using this, users can efficiently query for related vulnerabilities based on their textual descriptions and metadata.

The workflow includes:

Fetching CVE records from a PostgreSQL database.
Concatenating relevant fields (such as vendor, product, versions, descriptions, etc.) into a unified string format.
Generating sentence embeddings for these concatenated texts using a pre-trained model (paraphrase-MiniLM-L6-v2).
Normalizing the embeddings for cosine similarity calculations.
Indexing the embeddings using FAISS's HNSW (Hierarchical Navigable Small World) graph structure for efficient similarity search.
Saving the FAISS index for future retrieval and search.

## Features
- Efficient Vector Search: Uses FAISS (Facebook AI Similarity Search) for efficient similarity-based searches.
- Embedding Generation: Employs a lightweight and fast pre-trained sentence transformer model = (paraphrase-MiniLM-L6-v2) to convert CVE data into semantic embeddings.
- CVE Metadata Handling: Extracts and processes relevant CVE metadata such as vendors, products, versions, descriptions, and problem types.
- Database Connectivity: Connects to a PostgreSQL database to retrieve and process CVE data.
- Index Persistence: Saves the FAISS index to disk for persistent and fast retrieval of related CVE records.

## Prerequisites
To run this application locally or in a container, you need:
- Python 3.9+
- A running instance of PostgreSQL with a CVE table (cve.cve) containing JSON data.
- Docker (for containerization)
- Ensure you have enough space for storing the FAISS index file.

Install the dependencies locally by running:
```bash
pip install -r requirements.txt
```

## Repository Structure

```plaintext
llm-webapp-cve-generator/             
├── Dockerfile              
├── README.md               
├── generate.py           
├── Jenkinsfile     
├── Jenkinsfile2
├── get_next_version.py               
├── requirements.txt      
```

### What Each File Does
- **docker.yaml**: Contains the GitHub Actions workflow for building and pushing the multi-platform container image to DockerHub and scanning it for vulnerabilities using Trivy.

- **generate.py**: The core of the web application. It concatenates and processes CVE data, generates embeddings, and indexes them using FAISS.

- **requirements.txt**: Specifies the Python dependencies required to run the web application (faiss, numpy, sentence-transformers, PostgreSQL connector, etc.), to be installed while building the container image.

- **Dockerfile**: Configuration for building the web app Docker image. It sets up the necessary Python environment, installs dependencies and copies the application files.

- **Jenkinsfile**: Checks out the code for commit messages and ensures that the messaages adhere to conventional commit standards.

- **Jenkinsfile2**: Access the code, builds a multi-platform Docker image supporting ARM64 and AMD64 architectures, tags it with an appropriate version, and pushes it to DockerHub.

## Building a Docker Image

To build the Docker image for this web app:

1. Clone the repository:
   ```bash
   git clone https://github.com/cvelens/llm-webapp-cve-generator.git
   cd llm-webapp-cve-generator
   ```

2. Build the Docker image:
   ```bash
   docker build -t llm-webapp-cve-generator .
   ```

## CI/CD with Jenkins

The CI/CD pipeline for this web app includes two Jenkinsfiles:
- **Jenkinsfile**: This workflow checks out the code and ensures that the commit messages adhere to conventional commit standards.
- **Jenkinsfile2**: This workflow builds a multi-platform Docker image supporting ARM64 and AMD64 architectures, tags it with an appropriate version, and pushes it to DockerHub.

## Usage

Once the app is up and running, you can use the generated faiss_index.index file to perform similarity searches on the CVE data.

## Additional Notes
- Ensure that the PostgreSQL database is set up and running before starting the web application and the valid credentials are provided in the code.